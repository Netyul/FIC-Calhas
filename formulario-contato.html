<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <title>Form do Google</title>
    <meta charset="utf-8">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
    <script   src="http://code.jquery.com/jquery-3.0.0.min.js"   integrity="sha256-JmvOoLtYsmqlsWxa7mDSLMwa6dZ9rrIdtrrVYRnDRH0="   crossorigin="anonymous"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <!-- Latest compiled and minified JavaScript -->
   <script src="https://apis.google.com/js/client.js?onload=checkAuth"></script> 
   <script src="https://apis.google.com/js/api.js" type="text/javascript"></script>
  <script type="text/javascript">
   
   var IdCliente = '1054203316845-nnale04qnk6rv4bq0ej5o8nltt1fc7ua.apps.googleusercontent.com';
   var CliChave = 'AIzaSyA7T2ePTDIE1bsdQVcDvuBKTUlgsPJPmzc';
   var Scope =  ['https://www.googleapis.com/auth/spreadsheets'];

  function preventFormSubmit() {
    var forms = document.querySelectorAll('form');
    for (var i = 0; i < forms.length; i++) {
      forms[i].addEventListener('submit', function(event) {
        event.preventDefault();
        });
    }
  }
  window.addEventListener('load', preventFormSubmit);

 function handleClientLoad ()  { 
  gapi.client.setApiKey (CliChave); 
  window.setTimeout (checkAuth ,1); 
} 
function checkAuth() {
  gapi.auth.authorize({client_id: IdCliente, scope: Scope, immediate: true}, Result);
}
function click(){
  gapi.client.setApiKey(CliChave); 
 gapi.load('auth', init);
  var nome  = document.getElementById('FCnome').value;
    var email = document.getElementById('FCemail').value;
    var tel   = document.getElementById('FCtel').value;
    var des   = document.getElementById('FCdescription').value;

    var formVariavel ={
      FCnome        : nome,
      FCemail       : email,
      FCtel         : tel,
      FCdescription : des  
    }
    formPocess(formVariavel);
} 
 
function Result(authResult){
  var autorizeForm = document.getElementById("formularios");
  if (authResult && !authResult.error) {
    autorizeForm.style.display = "none";
    var div = document.getElementById('output');
    div.innerHTML = '<span>Obrigado! por entra em contato conosco.</span>';

    var nome  = document.getElementById('FCnome').value;
    var email = document.getElementById('FCemail').value;
    var tel   = document.getElementById('FCtel').value;
    var des   = document.getElementById('FCdescription').value;

    var formVariavel ={
      FCnome        : nome,
      FCemail       : email,
      FCtel         : tel,
      FCdescription : des  
    }
    formPocess(formVariavel);

    }else{
      autorizeForm.style.display = 'inline';
    }
  }
  function formPocess(FormProcess){
    gapi.client.setApiKey(CliChave); 
    var scriptId = "MEHIGpzDpU4cHOVxdlyiiQEFkVRYCbc2y";

    var request = {
    'function': 'processForm',
    'parameters': [FormProcess],
    'devMode': true   // Optional.
    };

    // Make the request.
    var op = gapi.client.request({
      'root': 'https://script.googleapis.com',
      'path': 'v1/scripts/' + scriptId + ':run',
      'method': 'POST',
      'body': request
    });

    op.execute(function(resp) {
      if (resp.error && resp.error.status) {
      // The API encountered a problem before the script started executing.
        console.log('Error calling API: ' + JSON.stringify(resp, null, 2));
      } else if (resp.error) {
      // The API executed, but the script returned an error.
        var error = resp.error.details[0];
        console.log('Script error! Message: ' + error.errorMessage);
      } else {
        // Here, the function returns an array of strings.
        var sheetNames = resp.response.result;
        console.log('Resultado a API Contato e: ' + sheetNames);
        
      }
    });
  }
</script>
<script type="text/javascript">
    /* Máscaras ER */
function mascara(o,f){
    v_obj=o;
    v_fun=f;
    setTimeout("execmascara()",1);
}
function execmascara(){
    v_obj.value=v_fun(v_obj.value);
}
function mtel(v){
    v=v.replace(/\D/g,"");             //Remove tudo o que não é dígito
    v=v.replace(/^(\d{2})(\d)/g,"($1) $2"); //Coloca parênteses em volta dos dois primeiros dígitos
    v=v.replace(/(\d)(\d{4})$/,"$1-$2");    //Coloca hífen entre o quarto e o quinto dígitos
    return v;
}
function id( el ){
	return document.getElementById( el );
}
window.onload = function(){
	id("FCtel").onkeypress = function(){
		mascara( this, mtel );
	}
}
  </script>
  </head>
  <body>
  
  <form  method="post" action="" id="formularios" onsubmit="click()">
   <div class="row">
    <label for="exampleInputEmail1" class="col-md-12">Nome:</label>
    <div class="col-md-12">
      <input type="text" class="form-control" name="FCnome" required="required" id="FCnome" placeholder="Seu nome">
    </div>
  </div>
  <div class="row">
    <label for="exampleInputEmail1" class="col-md-12">Email:</label>
    <div class="col-md-12">
      <input type="email" class="form-control" required="required" name="FCemail" id="FCemail" placeholder="Seu Email">
    </div>  
  </div>
  <div class="row">
    <label for="exampleInputPassword1" class="col-md-12">Telefone:</label>
    <div class="col-md-4">
      <input type="text" class="form-control"  required="required" maxlength="15" name="FCtel" id="FCtel" />
    </div>
  </div>
  <div class="row">
    <label for="exampleInputPassword1" class="col-md-12">Descrição:</label>
    <div class="col-md-12">
      <textarea class="form-control" rows="3" required="required" name="FCdescription" id="FCdescription"></textarea>
    </div>
  </div>
  <div class="row">
  <div class="col-md-12">
    <p>descreva tudo o que você presisa em seu orçamento</p>
  </div>
  </div>
  <button type="submit" class="btn btn-default btn-primary" id="enviar">Enviar</button>
</form>
<div id="output" class="text-center"></div>
    <table class="table table-bordered">
     
    </table>
  </body>
</html>
